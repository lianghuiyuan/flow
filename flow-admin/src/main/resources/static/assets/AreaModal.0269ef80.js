var P=Object.defineProperty;var E=Object.getOwnPropertySymbols;var v=Object.prototype.hasOwnProperty,M=Object.prototype.propertyIsEnumerable;var w=(e,s,t)=>s in e?P(e,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[s]=t,b=(e,s)=>{for(var t in s||(s={}))v.call(s,t)&&w(e,t,s[t]);if(E)for(var t of E(s))M.call(s,t)&&w(e,t,s[t]);return e};var F=(e,s,t)=>new Promise((u,o)=>{var c=a=>{try{n(t.next(a))}catch(l){o(l)}},i=a=>{try{n(t.throw(a))}catch(l){o(l)}},n=a=>a.done?u(a.value):Promise.resolve(a.value).then(c,i);n((t=t.apply(e,s)).next())});import{B as I,a as k}from"./index.ef1baeca.js";import{B as x}from"./BasicForm.35bf3188.js";import{u as S}from"./useForm.8dec0b63.js";import{dO as d,fC as C,f5 as O,az as R,a as N,w as T,j as g,h as $,aB as D,o as j,k as q,B as V,p as L,aC as U}from"./index.741c5d36.js";import{F as z}from"./constantEnum.bf6653fb.js";const re=[{title:"\u540D\u79F0",dataIndex:"name",align:"left"},{title:"\u7F16\u7801",dataIndex:"code",width:300,align:"left"},{title:"\u4FEE\u6539\u65F6\u95F4",dataIndex:"updateTime",width:180}],ae=[{field:"keyword",label:"\u5173\u952E\u5B57",component:"Input",componentProps:{placeholder:"\u8BF7\u8F93\u5165\u540D\u79F0/\u7F16\u7801"},labelWidth:60,colProps:{span:6,lg:{span:6,offset:0},sm:{span:10,offset:0},xs:{span:16,offset:0}}}],W=[{field:"pcode",label:"pcode",required:!1,component:"Input",show:!1},{field:"name",label:"\u540D\u79F0",required:!0,component:"Input",rules:[{required:!0,whitespace:!0,message:"\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A\uFF01"},{max:20,message:"\u5B57\u7B26\u957F\u5EA6\u4E0D\u80FD\u5927\u4E8E20\uFF01"}],colProps:{span:24}},{field:"code",label:"\u7F16\u7801",required:!0,component:"Input",colProps:{span:24}}],oe=e=>{const s=d.post({url:"/flow/base/area/getAreas",params:e});return Promise.resolve(s).then(t=>{const u=C(t,{id:"code",children:"children",pid:"pcode"});return O(u,o=>{o.children.length===0&&delete o.children},{id:"code",children:"children",pid:"pcode"}),u})},G=e=>d.post({url:"/flow/base/area/saveOrUpdate",params:e}),ue=e=>d.post({url:"/flow/base/area/delete/",params:e}),H=e=>d.post({url:"/flow/base/area/checkEntityExist",params:e}),J=N({name:"AreaModal",components:{BasicModal:I,BasicForm:x},emits:["success","register"],setup(e,{emit:s}){const t=T(!0),[u,{resetFields:o,updateSchema:c,setFieldsValue:i,validate:n}]=S({labelWidth:100,schemas:W,showActionButtonGroup:!1}),a=r=>[{trigger:"blur",validator:(p,B)=>B?H({id:r.id,field:r.field,fieldValue:B,fieldName:r.fieldName}).then(f=>f?Promise.resolve():Promise.reject(r.fieldName+"\u5DF2\u5B58\u5728\uFF0C\u8BF7\u4FEE\u6539\uFF01")).catch(f=>Promise.reject(f)):Promise.resolve()}],[l,{setModalProps:m,closeModal:A,changeLoading:h}]=k(r=>F(this,null,function*(){yield o(),m({confirmLoading:!1}),t.value=!!(r!=null&&r.isUpdate);let p=r.record;yield c([{field:"code",dynamicRules:()=>[{required:!0,whitespace:!0,message:"\u7F16\u7801\u4E0D\u80FD\u4E3A\u7A7A\uFF01"},{pattern:new RegExp(z.SN),type:"string",message:"\u8BF7\u8F93\u5165\u82F1\u6587\u6216\u6570\u5B57\uFF01"},{max:10,message:"\u5B57\u7B26\u957F\u5EA6\u4E0D\u80FD\u5927\u4E8E10\uFF01"},...a({id:g(t)&&p&&p.code||"",field:"code",fieldValue:"",fieldName:"\u6807\u8BC6"})]}]),g(t)&&i(b({},r.record))})),_=$(()=>g(t)?"\u4FEE\u6539":"\u65B0\u589E");function y(){return F(this,null,function*(){h(!0);try{m({confirmLoading:!0});const r=yield n();yield G(r),A(),s("success")}finally{m({confirmLoading:!1}),h(!1)}})}return{registerModal:l,registerForm:u,getTitle:_,handleSubmit:y}}});function K(e,s,t,u,o,c){const i=D("BasicForm"),n=D("BasicModal");return j(),q(n,U(e.$attrs,{onRegister:e.registerModal,title:e.getTitle,onOk:e.handleSubmit}),{default:V(()=>[L(i,{onRegister:e.registerForm},null,8,["onRegister"])]),_:1},16,["onRegister","title","onOk"])}var Q=R(J,[["render",K]]),ne=Object.freeze(Object.defineProperty({__proto__:null,default:Q},Symbol.toStringTag,{value:"Module"}));export{Q as A,ne as a,re as c,ue as d,oe as g,ae as s};
