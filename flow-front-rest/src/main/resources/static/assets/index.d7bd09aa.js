import{d9 as O,bF as $,aA as k,a as J,v as L,w as K,e as U,K as z,J as W,dc as q,bD as Q,V as X,R as Y,S as Z,bn as ee,m as T,_ as B,bk as te,as as F,aC as ne}from"./index.f3fe0f3f.js";import{t as I}from"./throttleByAnimationFrame.963da602.js";function y(n){return n!==window?n.getBoundingClientRect():{top:0,bottom:window.innerHeight}}function _(n,e,t){if(t!==void 0&&e.top>n.top-t)return"".concat(t+e.top,"px")}function H(n,e,t){if(t!==void 0&&e.bottom<n.bottom+t){var a=window.innerHeight-e.bottom;return"".concat(t+a,"px")}}var j=["resize","scroll","touchstart","touchmove","touchend","pageshow","load"],g=[];function R(n,e){if(!!n){var t=g.find(function(a){return a.target===n});t?t.affixList.push(e):(t={target:n,affixList:[e],eventHandlers:{}},g.push(t),j.forEach(function(a){t.eventHandlers[a]=O(n,a,function(){t.affixList.forEach(function(s){var w=s.exposed.lazyUpdatePosition;w()},(a==="touchstart"||a==="touchmove")&&$?{passive:!0}:!1)})}))}}function M(n){var e=g.find(function(t){var a=t.affixList.some(function(s){return s===n});return a&&(t.affixList=t.affixList.filter(function(s){return s!==n})),a});e&&e.affixList.length===0&&(g=g.filter(function(t){return t!==e}),j.forEach(function(t){var a=e.eventHandlers[t];a&&a.remove&&a.remove()}))}function ae(){return typeof window!="undefined"?window:null}var p;(function(n){n[n.None=0]="None",n[n.Prepare=1]="Prepare"})(p||(p={}));var ie=function(){return{offsetTop:Number,offsetBottom:Number,target:{type:Function,default:ae},prefixCls:String,onChange:Function,onTestUpdatePosition:Function}},re=J({compatConfig:{MODE:3},name:"AAffix",props:ie(),setup:function(e,t){var a=t.slots,s=t.emit,w=t.expose,h=L(),S=L(),f=K({affixStyle:void 0,placeholderStyle:void 0,status:p.None,lastAffix:!1,prevTarget:null,timeout:null}),x=ne(),P=U(function(){return e.offsetBottom===void 0&&e.offsetTop===void 0?0:e.offsetTop}),b=U(function(){return e.offsetBottom}),D=function(){var r=f.status,v=f.lastAffix,d=e.target;if(!(r!==p.Prepare||!S.value||!h.value||!d)){var l=d();if(!!l){var o={status:p.None},m=y(l),u=y(h.value),N=_(u,m,P.value),E=H(u,m,b.value);N!==void 0?(o.affixStyle={position:"fixed",top:N,width:u.width+"px",height:u.height+"px"},o.placeholderStyle={width:u.width+"px",height:u.height+"px"}):E!==void 0&&(o.affixStyle={position:"fixed",bottom:E,width:u.width+"px",height:u.height+"px"},o.placeholderStyle={width:u.width+"px",height:u.height+"px"}),o.lastAffix=!!o.affixStyle,v!==o.lastAffix&&s("change",o.lastAffix),F(f,o)}}},C=function(){F(f,{status:p.Prepare,affixStyle:void 0,placeholderStyle:void 0}),x.update()},c=I(function(){C()}),A=I(function(){var i=e.target,r=f.affixStyle;if(i&&r){var v=i();if(v&&h.value){var d=y(v),l=y(h.value),o=_(l,d,P.value),m=H(l,d,b.value);if(o!==void 0&&r.top===o||m!==void 0&&r.bottom===m)return}}C()});w({updatePosition:c,lazyUpdatePosition:A}),z(function(){return e.target},function(i){var r=(i==null?void 0:i())||null;f.prevTarget!==r&&(M(x),r&&(R(r,x),c()),f.prevTarget=r)}),z(function(){return[e.offsetTop,e.offsetBottom]},c),W(function(){var i=e.target;i&&(f.timeout=setTimeout(function(){R(i(),x),c()}))}),q(function(){D()}),Q(function(){clearTimeout(f.timeout),M(x),c.cancel(),A.cancel()});var V=X("affix",e),G=V.prefixCls;return function(){var i,r=f.affixStyle,v=f.placeholderStyle,d=Y(Z({},G.value,r)),l=ee(e,["prefixCls","offsetTop","offsetBottom","target","onChange","onTestUpdatePosition"]);return T(te,{onResize:c},{default:function(){return[T("div",B(B({},l),{},{style:v,ref:h}),[T("div",{class:d,ref:S,style:r},[(i=a.default)===null||i===void 0?void 0:i.call(a)])])]}})}}}),ue=k(re);export{ue as A};
